Trait Import (10 Scenarios)

Background:
GIVEN the user is 'Cucumber Breeder' in the program Cucumber
AND logs in to Bthe user with "<cucumberbreeder@mailinator.com>" | "<cucumber1>" 
AND selects "Traits" in the left navigation pane
AND selects "Import Traits"
AND

Scenario: Import Traits page
GIVEN the user is on the Import traits page
THEN the user can can see a header "Import traits"
AND the user can see a message stating "Before You Import...
Prepare trait information for import using the provided template."
AND the user can see a button "Download the Trait Import Template"
AND the user can see a button "Choose a file..."

Scenario: Traits - choosing a file
GIVEN the user is on the Import traits page
AND the user selects "Choose a File"
AND the user chooses file <Cucumber_traits.xls>
THEN the user can see "Cucumber_traits.xls"
AND the user can see a button "Choose a different file..."
AND the user can see a button "Import"

Scenario: Traits - choosing an xls file and selecting Import
GIVEN the user is on the Import traits page
AND the user selects Choose File
AND the user chooses a file <test_import-xls.xls>
WHEN the user selects "Import"
THEN the user is presented with a page with the header "Curate and Confirm New Traits"
AND the user can see a "Confirm" button
AND the user can see an "Abort" button
AND the user can see a list of traits in a table
AND the user can see "Name" 
AND the user can see "Level"
AND the user can see "Method"
AND the user can see "Scale"
AND the user can see each row has a "Show Details" link

Scenario: Traits - Abort Import, Modal
GIVEN the user is on the Import traits page
AND the user selects "Choose File"
AND the user chooses file <test_import-xls.xls>
AND the user selects "Import"
WHEN the user selects 'Abort' button
THEN a modal is presented
AND the user sees a warning ""Abort This Import"
AND the user sees the message "No traits will be added, and the import in progress will be completely removed."
AND the user sees a 'Yes, abort' button
AND the user sees a 'Cancel' button
select Cancel

Scenario: Traits - Abort Import, Cancel
GIVEN the user is on the Import traits page
AND the user selects "Choose File"
AND the user chooses file <test_import-xls.xls>
AND the user selects "Import"
AND the user selects 'Abort' button
WHEN the user selects 'Cancel' button
THEN the user goes back to the page with the header 'Curate and Confirm New Traits'

Scenario: Traits - Abort Import, Yes, Abort
GIVEN the user is on the Import traits page
AND the user selects "Choose File"
AND the user chooses file <test_import-xls.xls>
AND the user selects "Import"
AND the user selects 'Abort' button
WHEN the user selects 'Yes, abort' button
THEN the user can see a banner stating 'Imported cancelled'

Scenario: Traits - Confirm Import for xls file
GIVEN the user is on the Import traits page
AND the user selects "Choose File"
AND the user chooses file <test_import-xls.xls>
AND the user selects "Import"
WHEN the user selects 'Confirm' button
THEN the user can see a success banner stating 'Imported traits have been added to Cucumber."
*****AND the newly imported traits are listed in the 'All Traits' table

Scenario: Traits - Confirm Import for xlsx file
GIVEN the user is on the Import traits page
AND the user selects "Choose File"
AND the user chooses file <test_import-xlsx.xlsx>
AND the user selects "Import"
WHEN the user selects 'Confirm' button
THEN the user can see a success banner stating 'Imported traits have been added to Cucumber."
*****AND the newly imported traits are listed in the 'All Traits' table

Scenario: Traits - choosing a different file - xls, then a csv file
GIVEN the user is on the Import traits page
AND the user selects Choose File
AND the user chooses a file <test_import-xls.xls>
AND the user selects "Choose a different file..."
AND the user chooses a file <test_import-csv.csv>
THEN the user can see "Cucumber_traits.csv"
AND the user can see a button "Import"

Scenario: Traits - Confirm Import for csv file
GIVEN the user is on the Import traits page
AND the user selects "Choose File"
AND the user chooses file <Cucumber_traits.csv>
AND the user selects "Import"
WHEN the user selects 'Confirm' button
THEN the user can see a success banner stating 'Imported traits have been added to Cucumber."
*****AND the newly imported traits are listed in the 'All Traits' table

Scenario: Traits - Duplicate Trait Name
GIVEN the user is on the Import traits page
AND select Choose File
AND choose a file  with duplicate trait names <test_traits_dupTraitNames.xlsx>
AND the user select "Import"
THEN the user can see an error message "Trait name: Trait name duplicated in file. Duplicate set of traits are rows [2, 3] in row 2"
AND the user can see an error message "Trait name: Trait name duplicated in file. Duplicate set of traits are rows [2, 3] in row 3"

Scenario: Traits - missing column
GIVEN the user is on the Import traits page
AND select Choose File
AND choose a file  with missing "Trait status" column <test_traits_missingCol.xlsx>
AND the user select "Import"
THEN the user can see an error message "Error parsing excel: Missing expected columns [Trait status]"

Scenario: Traits - duplicate column
GIVEN the user is on the Import traits page
AND select Choose File
AND choose a file  with a duplicate column <test_traits_dupCol.xlsx>
AND the user select "Import"
THEN the user can see an error message "Error parsing excel: Found duplicate column names"

Scenario: Traits - missing formula
GIVEN the user is on the Import traits page
AND select Choose File
AND choose a file  with Computation as method level and no method formula <test_traits_missingFormula.xlsx>
AND the user select "Import"
THEN the user can see an error message "Method formula: Missing method formula for Computation method in row 2"

Scenario: Traits - missing scale categories
GIVEN the user is on the Import traits page
AND select Choose File
AND choose a file  with ordinal as scale class and no categories <test_traits_missingScaleCat.xlsx>
AND the user select "Import"
THEN the user can see an error message "Scale categories: Missing scale categories for Ordinal scale in row 3"
AND the user can see an error message "Scale categories: Missing scale categories for Ordinal scale in row 5"

Scenario: Traits - missing method and scale names
GIVEN the user is on the Import traits page
AND select Choose File
AND choose a file  with missing method name and missing scale name <test_traits_MissingNames.xlsx>
AND the user select "Import"
THEN the user can see an error message "Method name: Missing method name in row 3"
AND an error message  "Scale name: Missing scale name in row x"

Scenario: Traits - case sensitivity
GIVEN the user is on the Import traits page
AND select Choose File
AND chooses a file  with upper and lower case in the headers and other fields <test_traits_case_insensitivity.xlsx>
AND the user selects "Import"
THEN the user is presented with a page with the header "Curate and Confirm New Traits"

Scenario: Traits - extra columns
GIVEN the user is on the Import traits page
AND select Choose File
AND chooses a file  with extra columns <test_traits_extraCols.xlsx>
AND the user selects "Import"
THEN the user is presented with a page with the header "Curate and Confirm New Traits"
